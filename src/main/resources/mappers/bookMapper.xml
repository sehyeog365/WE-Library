<?xml version="1.0" encoding="UTF-8"?>

 <!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.marondal.welibrary.book.dao.BookDAO">
  
  	<!-- 책목록 조회 -->
  	<select id = "selectBookListByTitle" resultType="com.marondal.welibrary.book.model.Book" parameterType="map" >
	  	SELECT
	  		`id`
	  		, `library`
			, `title`
			, `imagePath`
			, `author`
			, `publisher`
			, `price`
			, `isbn`
			, `pubyear`
			, `appendix`
			, `createdAt`
			, `updatedAt`
	  	FROM
	  		`book`
	  	WHERE 	
	  		`title` = #{title}
	  	ORDER BY `id` DESC;
  	</select>	
  	
  	<!-- 책 1행정보 조회 -->
  	<select id = "selectBookById" resultType="com.marondal.welibrary.book.model.Book" parameterType="int">
  	
  		SELECT
  			`id`
	  		, `library`
			, `title`
			, `imagePath`
			, `author`
			, `publisher`
			, `price`
			, `isbn`
			, `pubyear`
			, `appendix`
			, `createdAt`
			, `updatedAt`
  		FROM
  			`book`
  		WHERE
  			`id` = #{id}

  	
  	</select>
  	
  	<!-- 대출 가능 여부 -->
  	<select id ="selectBorrowByBookId" resultType="int" parameterType="int">
  		SELECT
  			count(1)
  		FROM
  			`borrow_book`
  		WHERE
  			`bookId` = #{bookId}
  			
  	</select>
  	<!-- 예약 인원 세기  -->
  	<select id ="selectReserveBookId" resultType="int" parameterType="int">
  		SELECT 
  			count(1)
  		FROM
  			`reserve_book`
  		WHERE
  			`bookId` = #{bookId}
  	
  	</select>
  
  	<!-- 상호대차 가능 여부 -->
  	<select id="selectInteribraryBookId" resultType="int" parameterType="int">
  		SELECT
  			count(1)
  		FROM
  			`interibrary_book`
  		WHERE
  			`bookId` = #{bookId}
  	</select>
  </mapper>
  
